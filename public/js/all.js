function jsonResponse(t,e,n){try{var a=JSON.parse(t);a.e?swal({title:a.d,type:"error",confirmButtonText:"确定"},n):"function"==typeof e&&e(a.d)}catch(i){throw console.log(t),console.log(i),i}}$.material.init(),$(function(){function t(t){n=!1;var e=new FileReader;e.readAsDataURL(t),e.onload=function(e){""!=t.type&&"image/vnd.adobe.photoshop"!=t.type&&($("#jumbotron_img").get(0).src=e.target.result),$("#jumbotron_img_loading").show()},$("#if_btn_box").hide(),$("#if_submitting").show();var a=new FormData;a.append("file",t),a.append("platform",$("#platform").val());var i=new XMLHttpRequest;i.open("POST","/icon/upload",!0),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.onreadystatechange=function(){4==i.readyState&&200==i.status&&jsonResponse(i.responseText,function(t){location.href="/icon/detail/"+t},function(){n=!0,$("#if_btn_box").show(),$("#if_submitting, #jumbotron_img_loading").hide(),$("#jumbotron_img").get(0).src="img/launcher.png"})},i.send(a)}var e=$("#if_btn");if(e.length){e.on("click",function(){$("#if").click()}),$("#platform").select2({minimumResultsForSearch:1/0});var n=!0;$("#if").on("change",function(){var e=$(this);t(e.get(0).files[0])});var a=$("#if_form");a.get(0).addEventListener("dragover",function(t){t.stopPropagation(),t.preventDefault(),n&&a.addClass("dropping")},!1),a.get(0).addEventListener("dragleave",function(t){t.stopPropagation(),t.preventDefault(),n&&a.removeClass("dropping")},!1),a.get(0).addEventListener("drop",function(e){e.stopPropagation(),e.preventDefault(),n&&(a.removeClass("dropping"),e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files.length&&t(e.dataTransfer.files[0]))},!1)}var i=$("#subscribe");if(i.length){var o=i.parents("form").eq(0);i.on("click",function(){var t=($(this),o.find("input[type=email]")),e=$.trim(t.val()),n=/^[a-z0-9-_]([a-z0-9]*[-_]?[a-z0-9]+)*@([a-z0-9]*[-_]?[a-z0-9]+)+[\.][a-z]{2,3}([\.][a-z]{2})?$/i;return e&&n.test(e)?(o.hide().after('<div style="margin-top: 5px">订阅成功！即将发送到您的邮箱，请随后查收！</div>'),void $.post("/icon/subscribe",{design_id:"<?php echo $design->id ?>",mail:e})):void t.focus()}),o.on("submit",function(){i.click()})}var r=$("#tp_tabs");r.length&&$("#tp_tabs li a").first().click()});